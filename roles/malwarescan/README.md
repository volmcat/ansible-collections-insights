malwarescan
========

Installs, configures, and runs a Malware scan on a system connected to the [Red Hat Insights service](https://access.redhat.com/documentation/en-us/red_hat_insights/).  This role is intended to work on Red Hat Enterprise Linux.

Requirements
------------
- The Insights client must be installed and configured prior to using the malwarescan service. See the [rhc](https://github.com/linux-system-roles/rhc) role for an automated way to connect to RHSM and Red Hat Insights, or the existing [insights_client](../insights_client/README.md) role for automated deployment and configuration of the client.

- The host must be configured in the [Insights portal](https://console.redhat.com/insights/malware) prior to running a malware scan.

Role Variables / Configuration
--------------

N/A

Dependencies
------------

N/A

Example Playbook
----------------

The role can be used in three ways from a playbook, install only, run only, or all-in-one. The all-in-one is most common and recommend usage as it will ensure all pre-requisites are met prior to running a compliance scan.

```
---
- hosts: all
  
  tasks:
  - name: insights malware
    import_role:
      name: redhat.insights.malwarescan
```

If you only wish to install pre-requisites without running a malware scan the role may be used with only the "install" tasks as shown in the example below. 

```
---
- hosts: all

  tasks:
  - name: install insights malware
    import_role:
      name: redhat.insights.malwarescan
      tasks_from: install
```

To speed up malware scans after installation of prerequisites, the role may be run with only the "run" tasks as shown in the example below. Use caution when using this method as it can cause hosts to fail or become inconsistent with other hosts since prerequisites are not being checked and met prior to running a scan.

```
---
- hosts: all

  tasks:
  - name: run insights malware
    import_role:
      name: redhat.insights.malwarescan
      tasks_from: run
```
